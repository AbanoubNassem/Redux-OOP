{"version":3,"sources":["index.ts"],"names":["createStore","applyMiddleware","compose","combineReducers","reduxCombineReducers","thunk","SyncStorageActions","middleware","providers","reducers","p","hasOwnProperty","provider","reducerName","toLowerCase","reducer","initActionProviders","store","defaults","getState","dispatch","init","initStore","preloadState","extraMiddleware","extraEnhancers","devMode","push","require","createLogger","Store","ActionProviders","initStoreWithModules","Storage"],"mappings":"wIAAA,OACEA,WADF,CAEEC,eAFF,CAGEC,OAHF,CAIEC,eAAe,GAAIC,CAAAA,oBAJrB,KAMO,OANP,CAQA,MAAOC,CAAAA,KAAP,KAAkB,aAAlB,CAGA,OAASC,kBAAT,KAAmC,yCAAnC,CAEA,GAAIC,CAAAA,UAAe,CAAG,CAACF,KAAD,CAAtB,CAEA,QAASF,CAAAA,eAAT,CAAqDK,SAArD,CAA4E,CAC1E,GAAIC,CAAAA,QAAa,CAAG,EAApB,CAEA,IAAK,GAAIC,CAAAA,CAAT,GAAcF,CAAAA,SAAd,CAAyB,CACvB,GAAIA,SAAS,CAACG,cAAV,CAAyBD,CAAzB,CAAJ,CAAiC,CAC/B,GAAME,CAAAA,QAAQ,CAAIJ,SAAD,CAAmBE,CAAnB,CAAjB,CACA,GAAMG,CAAAA,WAAW,CAAGH,CAAC,CAACI,WAAF,EAApB,CACAL,QAAQ,CAACI,WAAD,CAAR,CAAyBD,QAAD,CAAkBG,OAAlB,EAAxB,CACD,CACF,CAED,MAAOX,CAAAA,oBAAoB,kBACtBK,QADsB,EAA3B,CAGD,CAED,QAASO,CAAAA,mBAAT,CACEC,KADF,CAEET,SAFF,CAGK,CACH,GAAIU,CAAAA,QAAa,CAAG,EAApB,CAEA,IAAK,GAAIR,CAAAA,CAAT,GAAcF,CAAAA,SAAd,CAAyB,CACvB,GAAIA,SAAS,CAACG,cAAV,CAAyBD,CAAzB,CAAJ,CAAiC,CAC/BQ,QAAQ,CAACR,CAAD,CAAR,CAAeF,SAAD,CAAmBE,CAAnB,CAAd,CACAQ,QAAQ,CAACR,CAAD,CAAR,CAAYS,QAAZ,CAAuB,iBAAMF,CAAAA,KAAK,CAACE,QAAN,EAAN,EAAvB,CACAD,QAAQ,CAACR,CAAD,CAAR,CAAYU,QAAZ,CAAuBH,KAAK,CAACG,QAA7B,CACAF,QAAQ,CAACR,CAAD,CAAR,CAAYW,IAAZ,GACD,CACF,CAED,MAAOH,CAAAA,QAAP,CACD,CAED,MAAO,SAASI,CAAAA,SAAT,CACLd,SADK,CAML,IAJAe,CAAAA,YAIA,2DAJoB,EAIpB,IAHAC,CAAAA,eAGA,2DAH8B,EAG9B,IAFAC,CAAAA,cAEA,2DAF6B,EAE7B,IADAC,CAAAA,OACA,2DADmB,IACnB,CACA,GAAIA,OAAJ,CAAa,CACXnB,UAAU,CAACoB,IAAX,CAAgBC,OAAO,CAAC,cAAD,CAAP,CAAwBC,YAAxB,EAAhB,EACD,CAED,GAAMC,CAAAA,KAAK,CAAG9B,WAAW,CACvBG,eAAe,CAACK,SAAD,CADQ,CAEvBe,YAFuB,CAGvBrB,OAAO,MAAP,SACED,eAAe,MAAf,QAAuBM,UAAvB,2BAAsCiB,eAAtC,GADF,4BAEKC,cAFL,GAHuB,CAAzB,CASA,GAAMM,CAAAA,eAAkB,CAAGf,mBAAmB,CAACc,KAAD,CAAQtB,SAAR,CAA9C,CACA,MAAO,CACLsB,KAAK,CAALA,KADK,CAELC,eAAe,CAAfA,eAFK,CAAP,CAID,CAED,MAAO,SAASC,CAAAA,oBAAT,EAML,IALAxB,CAAAA,SAKA,2DAL8B,EAK9B,IAJAe,CAAAA,YAIA,2DAJoB,EAIpB,IAHAC,CAAAA,eAGA,2DAH8B,EAG9B,IAFAC,CAAAA,cAEA,2DAF6B,EAE7B,IADAC,CAAAA,OACA,2DADmB,IACnB,CACA,MAAOJ,CAAAA,SAAS,gBAEZW,OAAO,CAAE,GAAI3B,CAAAA,kBAAJ,EAFG,EAGTE,SAHS,EAKde,YALc,CAMdC,eANc,CAOdC,cAPc,CAQdC,OARc,CAAhB,CAUD","sourcesContent":["import {\n  createStore,\n  applyMiddleware,\n  compose,\n  combineReducers as reduxCombineReducers,\n  Reducer\n} from \"redux\";\n\nimport thunk from \"redux-thunk\";\nimport { ActionProvider, IActionProviders } from \"../action-providers\";\nimport IModulesActionProviders from \"../modules\";\nimport { SyncStorageActions } from \"../modules/storage/sync-storage-actions\";\n\nlet middleware: any = [thunk];\n\nfunction combineReducers<T extends IActionProviders>(providers: T): Reducer {\n  let reducers: any = {};\n\n  for (let p in providers) {\n    if (providers.hasOwnProperty(p)) {\n      const provider = (providers as any)[p] as ActionProvider;\n      const reducerName = p.toLowerCase();\n      reducers[reducerName] = (provider as any).reducer();\n    }\n  }\n\n  return reduxCombineReducers({\n    ...reducers\n  });\n}\n\nfunction initActionProviders<T extends IActionProviders>(\n  store: any,\n  providers: T\n): T {\n  let defaults: any = {};\n\n  for (let p in providers) {\n    if (providers.hasOwnProperty(p)) {\n      defaults[p] = (providers as any)[p];\n      defaults[p].getState = () => store.getState();\n      defaults[p].dispatch = store.dispatch;\n      defaults[p].init();\n    }\n  }\n\n  return defaults;\n}\n\nexport function initStore<T extends IActionProviders>(\n  providers: T,\n  preloadState: any = {},\n  extraMiddleware: Array<any> = [],\n  extraEnhancers: Array<any> = [],\n  devMode: boolean = true\n) {\n  if (devMode) {\n    middleware.push(require(\"redux-logger\").createLogger());\n  }\n\n  const Store = createStore(\n    combineReducers(providers),\n    preloadState,\n    compose(\n      applyMiddleware(...[...middleware, ...extraMiddleware]),\n      ...extraEnhancers\n    )\n  );\n\n  const ActionProviders: T = initActionProviders(Store, providers);\n  return {\n    Store,\n    ActionProviders\n  };\n}\n\nexport function initStoreWithModules(\n  providers: IActionProviders = {},\n  preloadState: any = {},\n  extraMiddleware: Array<any> = [],\n  extraEnhancers: Array<any> = [],\n  devMode: boolean = true\n) {\n  return initStore<IModulesActionProviders>(\n    {\n      Storage: new SyncStorageActions(),\n      ...providers\n    },\n    preloadState,\n    extraMiddleware,\n    extraEnhancers,\n    devMode\n  );\n}\n"]}