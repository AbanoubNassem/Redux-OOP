{"version":3,"sources":["sync-storage-actions.ts"],"names":["StorageActionTypes","ActionProvider","reducer","PREFIX","SyncStorageActions","load","storage","i","len","localStorage","length","key","startsWith","value","JSON","parse","dispatchAction","STORAGE_LOADED","clear","STORAGE_CLEARED","saveOrUpdate","object","index","Object","keys","setItem","stringify","STORAGE_UPDATED","remove","deleted","Array","isArray","forEach","removeItem","STORAGE_REMOVED"],"mappings":"sRACA,MAAOA,CAAAA,kBAAP,KAA+B,gBAA/B,CACA,OAASC,cAAT,KAA+B,wBAA/B,CAEA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CAEA,GAAMC,CAAAA,MAAM,CAAG,YAAf,CAEA,UAAaC,CAAAA,kBAAb,4aAEEC,IAFF,CAES,UAAM,CACX,GAAMC,CAAAA,OAAY,CAAG,EAArB,CAEA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAR,CAAWC,GAAG,CAAGC,YAAY,CAACC,MAAnC,CAA2CH,CAAC,CAAGC,GAA/C,CAAoDD,CAAC,EAArD,CAAyD,CACvD,GAAII,CAAAA,GAAQ,CAAGF,YAAY,CAACE,GAAb,CAAiBJ,CAAjB,CAAf,CACA,GAAII,GAAG,CAACC,UAAJ,CAAeT,MAAf,CAAJ,CAA4B,CAC1B,GAAIU,CAAAA,KAAK,CAAGJ,YAAY,CAACE,GAAD,CAAxB,CACAL,OAAO,CAACK,GAAD,CAAP,CAAeG,IAAI,CAACC,KAAL,CAAWF,KAAX,CAAf,CACD,CACF,CAED,MAAKG,cAAL,CAAoBhB,kBAAkB,CAACiB,cAAvC,CAAuDX,OAAvD,EAEA,MAAOA,CAAAA,OAAP,CACD,CAhBH,OAkBEY,KAlBF,CAkBU,UAAM,CACZ,GAAMZ,CAAAA,OAAY,CAAG,EAArB,CAEAG,YAAY,CAACS,KAAb,GACA,MAAKF,cAAL,CAAoBhB,kBAAkB,CAACmB,eAAvC,CAAwDb,OAAxD,EAEA,MAAOA,CAAAA,OAAP,CACD,CAzBH,OA2BEc,YA3BF,CA2BiB,SAACC,MAAD,CAAiB,CAC9B,IAAK,GAAIC,CAAAA,KAAK,CAAG,CAAjB,CAAoBA,KAAK,CAAGC,MAAM,CAACC,IAAP,CAAYH,MAAZ,EAAoBX,MAAhD,CAAwDY,KAAK,EAA7D,CAAiE,CAC/D,GAAMX,CAAAA,GAAG,CAAGY,MAAM,CAACC,IAAP,CAAYH,MAAZ,EAAoBC,KAApB,CAAZ,CAEAb,YAAY,CAACgB,OAAb,CAAqBtB,MAAM,CAAGQ,GAA9B,CAAmCG,IAAI,CAACY,SAAL,CAAeL,MAAM,CAACV,GAAD,CAArB,CAAnC,EACD,CAED,MAAO,OAAKK,cAAL,CAAoBhB,kBAAkB,CAAC2B,eAAvC,CAAwDN,MAAxD,CAAP,CACD,CAnCH,OAqCEO,MArCF,CAqCW,UAAuC,IAAtCJ,CAAAA,IAAsC,2DAAP,EAAO,CAC9C,GAAIK,CAAAA,OAAY,CAAG,EAAnB,CAEA,GAAIC,KAAK,CAACC,OAAN,CAAcP,IAAd,CAAJ,CAAyB,CACvBA,IAAI,CAACQ,OAAL,CAAa,SAAArB,GAAG,CAAI,CAClBF,YAAY,CAACwB,UAAb,CAAwB9B,MAAM,CAAGQ,GAAjC,EACAkB,OAAO,CAAClB,GAAD,CAAP,CAAe,IAAf,CACD,CAHD,EAID,CALD,IAKO,CACLF,YAAY,CAACwB,UAAb,CAAwB9B,MAAM,CAAGqB,IAAjC,EACAK,OAAO,CAACL,IAAD,CAAP,CAAgB,IAAhB,CACD,CAED,MAAO,OAAKR,cAAL,CAAoBhB,kBAAkB,CAACkC,eAAvC,CAAwDL,OAAxD,CAAP,CACD,CAnDH,OAqDE3B,OArDF,CAqDY,iBAAMA,CAAAA,OAAN,EArDZ,2CAAwCD,cAAxC","sourcesContent":["import { IStorageActionProvider } from \"./index\";\nimport StorageActionTypes from \"./action-types\";\nimport { ActionProvider } from \"../../action-providers\";\n\nimport reducer from \"./reducer\";\n\nconst PREFIX = \"REDUX_OOP_\";\n\nexport class SyncStorageActions extends ActionProvider\n  implements IStorageActionProvider {\n  load = () => {\n    const storage: any = {};\n\n    for (let i = 0, len = localStorage.length; i < len; i++) {\n      let key: any = localStorage.key(i);\n      if (key.startsWith(PREFIX)) {\n        let value = localStorage[key];\n        storage[key] = JSON.parse(value);\n      }\n    }\n\n    this.dispatchAction(StorageActionTypes.STORAGE_LOADED, storage);\n\n    return storage;\n  };\n\n  clear = () => {\n    const storage: any = {};\n\n    localStorage.clear();\n    this.dispatchAction(StorageActionTypes.STORAGE_CLEARED, storage);\n\n    return storage;\n  };\n\n  saveOrUpdate = (object: any) => {\n    for (let index = 0; index < Object.keys(object).length; index++) {\n      const key = Object.keys(object)[index];\n\n      localStorage.setItem(PREFIX + key, JSON.stringify(object[key]));\n    }\n\n    return this.dispatchAction(StorageActionTypes.STORAGE_UPDATED, object);\n  };\n\n  remove = (keys: string | Array<string> = []) => {\n    let deleted: any = {};\n\n    if (Array.isArray(keys)) {\n      keys.forEach(key => {\n        localStorage.removeItem(PREFIX + key);\n        deleted[key] = null;\n      });\n    } else {\n      localStorage.removeItem(PREFIX + keys);\n      deleted[keys] = null;\n    }\n\n    return this.dispatchAction(StorageActionTypes.STORAGE_REMOVED, deleted);\n  };\n\n  reducer = () => reducer;\n}\n"]}